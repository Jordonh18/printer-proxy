[Unit]
Description=Printer Proxy Update Service
Documentation=https://github.com/Jordonh18/printer-proxy
After=network-online.target
Wants=network-online.target

# Don't start automatically - only when triggered
RefuseManualStop=no

[Service]
Type=oneshot

# Run as root since we need to install packages
User=root
Group=root

# Read update parameters from the request file
ExecStart=/opt/printer-proxy/scripts/update_runner.sh

# Clean up on success or failure
ExecStopPost=/bin/rm -f /var/lib/printer-proxy/update_request.json

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=printer-proxy-update

# Security hardening
ProtectSystem=false
ProtectHome=true
NoNewPrivileges=false
PrivateTmp=true

[Install]
WantedBy=multi-user.target
